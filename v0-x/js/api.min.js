function getStufen(){$.ajax({contentType:"Content-type: text/html; charset=iso-8859-1",url:GURL+"Schueler-Stundenplan/frames/navbar.htm",beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey),e.overrideMimeType("text/html;charset=iso-8859-1")},type:"GET",success:function(e){var t=e.split("var classes = ")[1].split(";")[0].replace(/(")|(\[)|(])|( )/g,"").split(",");GStufeA=t,t.forEach(function(e){$("#stufe").append("<option>"+e+"</option>")})},error:function(e,t,r){alert("Serververbindung fehlgeschlagen: "+r+"\nEin reload könnte helfen")}})}function getKurse(e){$.ajax({contentType:"Content-type: text/html; charset=iso-8859-1",url:GURL+"Schueler-Stundenplan/frames/navbar.htm",beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey),e.overrideMimeType("text/html;charset=iso-8859-1")},type:"GET",success:function(t){var r=[];(t=(t=t.split('<select name="week" class="selectbox" onChange="doDisplayTimetable(NavBar, topDir);">')[1]).split("</select>")[0]).split('<option value="').splice(1,2).forEach(function(e,t){r[t]=e.split('"')[0]});var n=r[0]%2==0?r[0]:r[1],a=r[0]%2!=0?r[0]:r[1],i=GURL+"Schueler-Stundenplan/"+("a"===e?n:a)+"/c/c"+to5erString(GStufeid)+".htm";console.log(i),GTTUrls.push([i,"a"===e]),$.ajax({contentType:"Content-type: text/html; charset=iso-8859-1",url:i,beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey),e.overrideMimeType("text/html;charset=iso-8859-1")},success:function(t){evaKurse(t,e)},error:function(e,t,r){alert("Serververbindung fehlgeschlagen: "+r+"\nEin reload könnte helfen")}})}})}function evaKurse(e,t){var r=[],n=$(e.replace(/\r?\n|\r/g,"").toUpperCase()).children("table")[0];$(n).children("tbody").children("tr")[0].remove(),n=$(n).children("tbody")[0],$(n).find("b").each(function(){"PAUSE"===$(this).html()&&$(this).parents().eq(6).attr("id","pause").html(" ")});var a=0;$(n).children("tr").each(function(e){var n=$(this);if(!n.is("#pause")){var i=[];if(""===n.html())return a++,void n.remove();n.children("td").each(function(r){var n=r;if(0!==r){var s=!1;"4"===$(this).attr("rowspan")&&(s=!0);var h=$(this).children("table").children("tbody").children("tr");if(1===h.length){var l=h.find("font");if(1===l.length&&""!==l.html())return;var c=$(l[0]).children("b").html(),o=$(l[1]).html(),u=$(l[2]).html(),f={type:"klasse",isBig:s,fach:c,lehrer:o,raum:u,pos:[e-a+1,n-1]};i.push(f)}else{c=h.find("font").children("b").html();var d=[];h.each(function(e){if(0!==e){var r=$($(this).children("td")[0]).children("font").html(),n=$($(this).children("td")[1]).children("font").html(),a=$($(this).children("td")[2]).children("font").html();d.push({kurs:r,raum:a}),addKurs({title:c,fach:r,lehrer:n},t)}});f={type:"kurs",fach:c,isBig:s,raeume:d};i.push(f)}}}),r.push(i)}});for(var i=[],s=0;s<r.length;s++)if(0!==r[s].length){i.push(r[s]);var h="a"===t?0:1}var l={days:[[],[],[],[],[]]};i.forEach(function(e,t){e.forEach(function(e,r){for(var n={},a=r,i=t,s=l.days[a][i];void 0!==s;)i++,s=l.days[a][i];void 0===e.fach&&"klasse"!==e.fach||("klasse"===e.type?n={type:e.type,fach:e.fach,lehrer:e.lehrer,raum:e.raum}:"kurs"===e.type&&(n={type:e.type,fach:e.fach,raeume:e.raeume})),l.days[a][i]=n,e.isBig&&(l.days[a][i+1]=n)})});for(s=0;s<5;s++)l.days[s].splice(6,0,{});GTimeTable[h]=l,TTLoaded()}function addKurs(e,t){for(var r=null,n="a"===t?0:1,a=0;a<GKURSE[n].kurse.length;a++)e.fach===GKURSE[n].kurse[a].fach&&(r=a);null===r&&GKURSE[n].kurse.push({fach:e.fach,lehrer:e.lehrer,title:e.title})}