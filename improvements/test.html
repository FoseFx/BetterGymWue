<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
</head>
<body>
<script>
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };
</script>
<script src="old.js"></script>
<script src="new.js"></script>

<script>
    let s = `<html>
<head>
<title>Untis 2017 Vertretungsplan</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="expires" content="0">
<style type="text/css">

body { margin-top: 0px; margin-left: 20px; margin-right: 20px;
background: #fff; color: #272727; font: 80% Arial, Helvetica, sans-serif; }

h1 { color: #ee7f00; font-size: 150%; font-weight: normal;}
h1 strong { font-size: 200%; font-weight: normal; }
h2 { font-size: 125%;}

h1, h2 { margin: 0; padding: 0;}


th { background: #000; color: #fff; }
table.mon_list th, td { padding: 8px 4px;}


.mon_title
{
	font-weight: bold;
	font-size: 120%;
	clear: both;
	margin: 0;
}

.inline_header
{
	font-weight: bold;
}

table.info
{
	color: #000000;
	font-size: 100%;
	border: 1px;
	border-style:solid;
	border-collapse:collapse;
	padding: 8px 4px;
}

table.mon_list
{
	color: #000000;
	width: 100%;
	font-size: 100%;
	border: 1px;
	border-style:solid;
	border-collapse:collapse;
}

table.mon_head
{
	color: #000000;
	width: 100%;
	font-size: 100%;
}

td.info,
th.list,
td.list,
tr.list
{
	border: 1px;
	border-style: solid;
	border-color: black;
	margin: 0px;
	border-collapse:collapse;
	padding: 3px;
}

tr.odd { background: #fad3a6; }
tr.even { background: #fdecd9; }

</style>
<meta name="generator" content="Untis 2017">
<meta name="company" content="Gruber &amp; Petters Software, A-2000 Stockerau, Austria, www.untis.at">
<meta http-equiv="refresh" content="10; URL=subst_001.htm">
</head>

Stand: 13.07.2018 07:58<p>
<body bgcolor="#F0F0F0">
<CENTER>
<font size="3" face="Arial">
<div class="mon_title">13.7.2018 Freitag, Woche A</div>
<table class="info" >
<tr class="info"><th class="info" align="center" colspan="2">Nachrichten zum Tag</th></tr>
<tr class='info'><td class='info' colspan="2"><b>SCHÖNE FERIEN!</b></td></tr>
</table>
<p>
<table class="mon_list" >
<tr class='list'><th class="list" align="center" width='5'>Datum</th><th class="list" align="center" width='4'>Stunde</th><th class="list" align="center" width='5'>(Fach)</th><th class="list" align="center" width='7'><b>Art</b></th><th class="list" align="center" width='8'>(Raum)</th><th class="list" align="center" width='8'>Raum</th><th class="list" align="center" width='50'>Vertretungs-Text</th></tr>
<tr class='list odd'><td class="list inline_header" colspan="7" >05B  05B-Str-Rtm</td></tr>
<tr class='list even'><td class="list" align="center">13.7.</td><td class="list" align="center">3</td><td class="list" align="center">MU</td><td class="list" align="center"><b>Vertretung</b></td><td class="list" align="center">MU1</td><td class="list" align="center">MU1</td><td class="list" align="center">Klassenlehrerstunde</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">4</td><td class="list" align="center">MU</td><td class="list" align="center"><b>Vertretung</b></td><td class="list" align="center">MU1</td><td class="list" align="center">MU1</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list even'><td class="list inline_header" colspan="7" >06B  06B-WS-Hls</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">1 - 2</td><td class="list" align="center">MU</td><td class="list" align="center"><b>Statt-Vertretung</b></td><td class="list" align="center">MU1</td><td class="list" align="center">403</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list even'><td class="list inline_header" colspan="7" >08A  08A-Ad-Hk</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">5 - 6</td><td class="list" align="center">MU</td><td class="list" align="center"><b>Vertretung</b></td><td class="list" align="center">MU2</td><td class="list" align="center">MU2</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list even'><td class="list inline_header" colspan="7" >EF  EF-Kh-Flb</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">1</td><td class="list" align="center">D2</td><td class="list" align="center"><b>Vertretung</b></td><td class="list" align="center">A02</td><td class="list" align="center">A02</td><td class="list" align="center">selbständiges Arbeiten</td></tr>
<tr class='list even'><td class="list" align="center">13.7.</td><td class="list" align="center">2</td><td class="list" align="center">D2</td><td class="list" align="center"><b>Vertretung</b></td><td class="list" align="center">A02</td><td class="list" align="center">A02</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list odd'><td class="list inline_header" colspan="7" >Q1  Q1-Ask-Ly</td></tr>
<tr class='list even'><td class="list" align="center">13.7.</td><td class="list" align="center">1 - 2</td><td class="list" align="center">SP1</td><td class="list" align="center"><b>Raum-Vtr.</b></td><td class="list" align="center">THGym</td><td class="list" align="center">304</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">1 - 2</td><td class="list" align="center">SP4</td><td class="list" align="center"><b>Raum-Vtr.</b></td><td class="list" align="center">KRH3</td><td class="list" align="center">305</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list even'><td class="list" align="center">13.7.</td><td class="list" align="center">1 - 2</td><td class="list" align="center">SP2</td><td class="list" align="center"><b>Raum-Vtr.</b></td><td class="list" align="center">KRH1</td><td class="list" align="center">402</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">1 - 2</td><td class="list" align="center">SP3</td><td class="list" align="center"><b>Vertretung</b></td><td class="list" align="center">KRH2</td><td class="list" align="center">KRH2</td><td class="list" align="center">Selbstständiges Arbeiten</td></tr>
<tr class='list even'><td class="list inline_header" colspan="7" >-----</td></tr>
<tr class='list odd'><td class="list" align="center">13.7.</td><td class="list" align="center">4/5</td><td class="list">&nbsp;</td><td class="list" align="center"><b>Pausenaufsicht</b></td><td class="list" align="center">Kl Hof</td><td class="list" align="center">Kl Hof</td><td class="list" align="center">&nbsp;</td></tr>
</table>
<p>
<font size="3" face="Arial">
Periode14   13.7.2018 A (46) (28)   Gymnasium der Stadt Würselen
</font></font>

</CENTER>
<p><center><font face="Arial" size="2"><a href="http://www.untis.at" target="_blank" >Untis Stundenplan Software</a></font></center>
</body>
</html>

`;

let s2 = `
<html>
<head>
<title>Untis 2017 Vertretungsplan</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="expires" content="0">
<style type="text/css">

body { margin-top: 0px; margin-left: 20px; margin-right: 20px;
background: #fff; color: #272727; font: 80% Arial, Helvetica, sans-serif; }

h1 { color: #ee7f00; font-size: 150%; font-weight: normal;}
h1 strong { font-size: 200%; font-weight: normal; }
h2 { font-size: 125%;}

h1, h2 { margin: 0; padding: 0;}


th { background: #000; color: #fff; }
table.mon_list th, td { padding: 8px 4px;}


.mon_title
{
	font-weight: bold;
	font-size: 120%;
	clear: both;
	margin: 0;
}

.inline_header
{
	font-weight: bold;
}

table.info
{
	color: #000000;
	font-size: 100%;
	border: 1px;
	border-style:solid;
	border-collapse:collapse;
	padding: 8px 4px;
}

table.mon_list
{
	color: #000000;
	width: 100%;
	font-size: 100%;
	border: 1px;
	border-style:solid;
	border-collapse:collapse;
}

table.mon_head
{
	color: #000000;
	width: 100%;
	font-size: 100%;
}

td.info,
th.list,
td.list,
tr.list
{
	border: 1px;
	border-style: solid;
	border-color: black;
	margin: 0px;
	border-collapse:collapse;
	padding: 3px;
}

tr.odd { background: #fad3a6; }
tr.even { background: #fdecd9; }

</style>
<meta name="generator" content="Untis 2017">
<meta name="company" content="Gruber &amp; Petters Software, A-2000 Stockerau, Austria, www.untis.at">
<meta http-equiv="refresh" content="10; URL=subst_002.htm">
</head>

Stand: 13.07.2018 07:58<p>
<body bgcolor="#F0F0F0">
<CENTER>
<font size="3" face="Arial">
<div class="mon_title">13.7.2018 Freitag, Woche A (Seite 1 / 2)</div>
<table class="info" >
<tr class="info"><th class="info" align="center" colspan="2">Nachrichten zum Tag</th></tr>
<tr class="info"><td class="info" align="left">Abwesende Lehrer&nbsp;</td><td class="info" align="left">Beu (1-2), Hgn, Ku, Zim (1-2)</td></tr>
<tr class='info'><td class='info' colspan="2"><b>SCHÖNE FERIEN!</b></td></tr>
</table>
<p>
<table class="mon_list" >
<tr class='list'><th class="list" align="center" width='5'>Vertr.</th><th class="list" align="center" width='5'>Std</th><th class="list" align="center" width='13'>Klasse</th><th class="list" align="center">Fach</th><th class="list" align="center">Raum</th><th class="list" align="center">fehlt</th><th class="list" align="center" width='17'>Art</th><th class="list" align="center" width='42'>Vertretungs-Text</th></tr>
<tr class='list odd'><td class="list inline_header" colspan="8" >Hel  Helling</td></tr>
<tr class='list even'><td class="list" align="center">Hel</td><td class="list" align="center">1 - 2</td><td class="list" align="center">Q1</td><td class="list" align="center">SP2</td><td class="list" align="center">402</td><td class="list" align="center">Hel</td><td class="list" align="center">Raum-Vtr.</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list odd'><td class="list inline_header" colspan="8" >Hgn  Hagen</td></tr>
<tr class='list even'><td class="list" align="center">???</td><td class="list" align="center">4</td><td class="list" align="center">05B</td><td class="list" align="center">MU</td><td class="list" align="center">MU1</td><td class="list" align="center">Hgn</td><td class="list" align="center">Absenz</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list odd'><td class="list" align="center">???</td><td class="list" align="center">4/5</td><td class="list">&nbsp;</td><td class="list">&nbsp;</td><td class="list" align="center">Kl Hof</td><td class="list" align="center">Hgn</td><td class="list" align="center">Absenz</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list even'><td class="list" align="center">???</td><td class="list" align="center">5 - 6</td><td class="list" align="center">08A</td><td class="list" align="center">MU</td><td class="list" align="center">MU2</td><td class="list" align="center">Hgn</td><td class="list" align="center">Absenz</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list odd'><td class="list inline_header" colspan="8" >Ptr  Peters</td></tr>
<tr class='list even'><td class="list" align="center">Ptr</td><td class="list" align="center">1 - 2</td><td class="list" align="center">06B</td><td class="list" align="center">MU</td><td class="list" align="center">403</td><td class="list" align="center">Hgn</td><td class="list" align="center">Statt-Vertretung</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list odd'><td class="list inline_header" colspan="8" >Pzz  Pezzolla</td></tr>
<tr class='list even'><td class="list" align="center">Pzz</td><td class="list" align="center">1 - 2</td><td class="list" align="center">Q1</td><td class="list" align="center">SP4</td><td class="list" align="center">305</td><td class="list" align="center">Pzz</td><td class="list" align="center">Raum-Vtr.</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list odd'><td class="list inline_header" colspan="8" >Sim  Simons</td></tr>
<tr class='list even'><td class="list" align="center">Sim</td><td class="list" align="center">1 - 2</td><td class="list" align="center">Q1</td><td class="list" align="center">SP1</td><td class="list" align="center">304</td><td class="list" align="center">Sim</td><td class="list" align="center">Raum-Vtr.</td><td class="list" align="center">Raumwechsel</td></tr>
<tr class='list odd'><td class="list inline_header" colspan="8" >!</td></tr>
<tr class='list even'><td class="list" align="center">!</td><td class="list" align="center">1</td><td class="list" align="center">EF</td><td class="list" align="center">D2</td><td class="list" align="center">A02</td><td class="list" align="center">Beu</td><td class="list" align="center">Vertretung</td><td class="list" align="center">selbständiges Arbeiten</td></tr>
<tr class='list odd'><td class="list" align="center">!</td><td class="list" align="center">2</td><td class="list" align="center">EF</td><td class="list" align="center">D2</td><td class="list" align="center">A02</td><td class="list" align="center">Beu</td><td class="list" align="center">Vertretung</td><td class="list" align="center">&nbsp;</td></tr>
<tr class='list even'><td class="list" align="center">!</td><td class="list" align="center">3</td><td class="list" align="center">05B</td><td class="list" align="center">MU</td><td class="list" align="center">MU1</td><td class="list" align="center">Hgn</td><td class="list" align="center">Vertretung</td><td class="list" align="center">Klassenlehrerstunde</td></tr>
</table>
<p>
<font size="3" face="Arial">
Periode14   13.7.2018 A (46) (28)   Gymnasium der Stadt Würselen
</font></font>

</CENTER>
<p><center><font face="Arial" size="2"><a href="http://www.untis.at" target="_blank" >Untis Stundenplan Software</a></font></center>
</body>
</html>

`;
</script>

<script>

    function compareObjects(o, p)
    {
        var i,
            keysO = Object.keys(o).sort(),
            keysP = Object.keys(p).sort();
        if (keysO.length !== keysP.length)
            return false;//not the same nr of keys
        if (keysO.join('') !== keysP.join(''))
            return false;//different keys
        for (i=0;i<keysO.length;++i)
        {
            if (o[keysO[i]] instanceof Array)
            {
                if (!(p[keysO[i]] instanceof Array))
                    return false;
                //if (compareObjects(o[keysO[i]], p[keysO[i]] === false) return false
                //would work, too, and perhaps is a better fit, still, this is easy, too
                if (p[keysO[i]].sort().join('') !== o[keysO[i]].sort().join(''))
                    return false;
            }
            else if (o[keysO[i]] instanceof Date)
            {
                if (!(p[keysO[i]] instanceof Date))
                    return false;
                if ((''+o[keysO[i]]) !== (''+p[keysO[i]]))
                    return false;
            }
            else if (o[keysO[i]] instanceof Function)
            {
                if (!(p[keysO[i]] instanceof Function))
                    return false;
                //ignore functions, or check them regardless?
            }
            else if (o[keysO[i]] instanceof Object)
            {
                if (!(p[keysO[i]] instanceof Object))
                    return false;
                if (o[keysO[i]] === o)
                {//self reference?
                    if (p[keysO[i]] !== p)
                        return false;
                }
                else if (compareObjects(o[keysO[i]], p[keysO[i]]) === false)
                    return false;//WARNING: does not deal with circular refs other than ^^
            }
            if (o[keysO[i]] !== p[keysO[i]])//change !== to != for loose comparison
                return false;//not the same value
        }
        return true;
    }


    console.log("Testing Schüler");
    let new0 = performance.now();
    let resnew = newF(s, false);
    let new1 = performance.now();
    console.log('now took', (new1-new0).toFixed(4), 'ms');
    let old0 = performance.now();
    let resold = old(s, false);
    let old1 = performance.now();
    console.log('old took', (old1-old0).toFixed(4), 'ms');
    console.log('diff', (Math.max(old1-old0, new1-new0) - Math.min(old1-old0, new1-new0)).toFixed(4) + ' ms');
    console.log((Math.max(old1-old0, new1-new0) / Math.min(old1-old0, new1-new0)).toFixed(4) + ' mal so schnell');

    console.log("Testing Lehrer");
    let new2 = performance.now();
    resnew = newF(s2, true);
    let new3 = performance.now();
    console.log("new took", (new3-new2).toFixed(4), 'ms');

    let old2 = performance.now();
    resold = old(s2, true);
    let old3 = performance.now();
    console.log('old took', (old3-old2).toFixed(4), 'ms');

    console.log('diff', (Math.max(old3-old2, new3-new2) - Math.min(old3-old2, new3-new2)).toFixed(4) + ' ms');
    console.log((Math.max(old3-old2, new3-new2) / Math.min(old3-old2, new3-new2)).toFixed(4) + ' mal so schnell');


</script>


</body>
</html>