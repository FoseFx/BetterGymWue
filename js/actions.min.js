function login(e,t){$.ajax({type:"GET",contentType:"Content-type: text/html; charset=iso-8859-1",beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+e),t.overrideMimeType("text/html;charset=iso-8859-1")},url:GURL+"Schueler-Stundenplan/default.htm",success:function(t){Auth(e)},error:function(e,s,n){console.log(n),t===CLICK?unAuth():(moveInLogin(),setTimeout(function(){unAuth()},1500))}})}function accessStufe(){moveOutStufe(),null===checkCookie("kl")||null===checkCookie("tt")?(startSpinner(),getKurse("a"),getKurse("b")):scrawl()}function orderGKURSE(){GKURSE.forEach(function(e){var t=[];e.kurse.forEach(function(e){var s=!0;t.forEach(function(n){if(0===t.length)return!0;n[0]===e.title&&(s=!1)}),s?t.push([e.title,[e]]):t.forEach(function(s,n){s[0]===e.title&&t[n][1].push(e)})}),e.kurse=[],t.forEach(function(t){t[1].forEach(function(t){e.kurse.push(t)})})})}function TTLoaded(){null===checkCookie("kl")?($("#selectkurs-wrapper").removeClass("hidden"),orderGKURSE(),GKURSE.forEach(function(e){var t=null;e.kurse.forEach(function(e){var s=!1;if(layedKurse.forEach(function(t){t===e.fach&&(s=!0)}),!s){layedKurse.push(e.fach),t!==e.title&&$("#selectkurs-inner-wrapper").append('<div class="kurs-select"><div class="kurs-select-inner"><div><span>Frei</span></div><h6>'+e.title+"</h6></div></div>"),t=e.title,$("#selectkurs-inner-wrapper").append('<div class="kurs-select"><div class="kurs-select-inner"><div><span>'+e.fach+"</span></div><h6>"+e.title+"</h6></div></div>");var n=$("<span>"+e.title+"</span>"),o=!1;avTitles.forEach(function(t){t.title===e.title&&(o=!0)}),o||n.appendTo("#kurse-title-container"),avTitles.push({title:e.title,used:0,span:n})}})}),stopSpinner()):scrawl()}function loadWIthID(){if(allowLoad){allowLoad=!1;var e=$("#KursIDBox"),t=e.val();e.prop("disabled",!0),$.ajax({url:"https://www.fosefx.com/betterGymWue/kursAPI.php",type:"get",data:"get="+t,success:function(t){if(!1===(t=$.parseJSON(t)).result)return e.prop("disabled",!1).val(""),allowLoad=!0,$("#bigIDBox").addClass("shake shake-constant"),void setTimeout(function(){$("#bigIDBox").removeClass("shake shake-constant")},200);GMyKurse=t.kurse,$("#diff, #bigIDBox").remove(),doAfterKursClick()},error:function(t){console.log(t),alert("Verbindung mit Datenbank fehlgeschlagen"),allowLoad=!0,e.prop("disabled",!1)}})}}function doAfterKursClick(){var e={a:GMyKurse},t=JSON.stringify(e),s=splitter(t,3500);s.forEach(function(e,t){document.cookie="k"+t+"="+e+EXP}),document.cookie="kl="+s.length+EXP,$("#selectkurs-wrapper").addClass("hidden"),scrawl()}function slide(e){var t=$(".tag").toArray();$(t[e?0:1]).show(),$(t[e?1:0]).hide(),e?($("#rightarrow").css("opacity","0.75"),$("#leftarrow").css("opacity","0")):($("#leftarrow").css("opacity","0.75"),$("#rightarrow").css("opacity","0"))}function controls(e){e?$("#controls").addClass("active"):$("#controls").removeClass("active")}function kursChange(){for(var e=0;e<checkCookie("kl");e++)delete_cookie("k"+e);delete_cookie("kl"),location.reload()}function stufeChange(){delete_cookie("stufe"),delete_cookie("stufeid"),kursChange()}function ttClicked(){if(void 0!==GTTUrls[0]&&($("#page-wraper").css("opacity","0"),setTimeout(function(){$("#page-wraper").css("display","none"),$("#ttDispl").css("display","flex"),setTimeout(function(){$("#ttDispl").css("opacity","1")},300)},300),!wasHere)){wasHere=!0;var e;GTTUrls.forEach(function(t){t[1]===(getWeekOfYear(new Date)%2==0)&&(e=t[0])}),$.ajax({contentType:"Content-type: text/html; charset=iso-8859-1",url:e,beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey),e.overrideMimeType("text/html;charset=iso-8859-1")},type:"GET",error:function(){$("page-wraper").css("display","block"),setTimeout(function(e){$("#page-wraper").css("opacity","1")},100)},success:function(e){var t=$(e).children("table")[0],s="";$(t).addClass("ttTable");var n=[];GMyKurse.forEach(function(e){s+="font:contains('"+e.fach+"'),",n.push(e.fach)}),s=s.substr(0,s.length-1),console.log(s),$(t).find(s).each(function(){var e=$(this),t=e.html().replace(new RegExp("\n","g"),"").replace(new RegExp(" ","g"),"");0===e.parent().index()&&-1!==n.indexOf(t)&&e.parent().parent().css("background-color","yellow")}),$("#ttDispl").append(t)}})}}function closeTT(){$("#ttDispl").css("display","none"),setTimeout(function(){$("#ttDispl").css("opacity","0"),setTimeout(function(){$("#page-wraper").css("display","block"),setTimeout(function(e){$("#page-wraper").css("opacity","1")},300)},300)},300)}function delete_cookie(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}var CLICK=0;$("#termsaccept").on("click",function(e){e.preventDefault(),document.cookie="a=true;expires=Fri, 31 Dec 9999 23:59:59 GMT",$("#terms").css("display","none"),checkLoginCookie()}),$("#login-form").submit(function(e){e.preventDefault(),console.log($("#select").val()+":"+$("#psw").val()),login(btoa($("#select").val()+":"+$("#psw").val()),CLICK)});var selectedKurse=[],avTitles=[],layedKurse=[];$("#selectkurs-inner-wrapper").on("click",".kurs-select",function(){if($(this).hasClass("selected")){$(this).removeClass("selected");var e=$(this).find("span").html(),t=$(this).find("h6").html();avTitles.forEach(function(e){e.title===t&&(--e.used>1?e.span.css("color","red").css("font-weight","600").css("font-style","italic"):1===e.used?e.span.css("color","green").css("font-weight","300").css("font-style","normal"):e.span.css("color","black").css("font-weight","600").css("font-style","normal"))}),selectedKurse.push(e)}else{$(this).addClass("selected");var e=$(this).find("span").html(),t=$(this).find("h6").html();avTitles.forEach(function(e){e.title===t&&(++e.used>1?e.span.css("color","red").css("font-weight","600").css("font-style","italic"):1===e.used&&e.span.css("color","green").css("font-weight","300").css("font-style","normal"))}),selectedKurse.push(e)}}),$("#stufe-form").submit(function(e){if(e.preventDefault(),""!==$("#stufe").val()){Gstufe=$("#stufe").val();for(var t=0;t<GStufeA.length;t++)GStufeA[t]===Gstufe&&(GStufeid=t+1);document.cookie="stufe="+Gstufe+EXP,document.cookie="stufeid="+GStufeid+EXP,accessStufe()}}),$("#kurseSelected").click(function(e){e.preventDefault();var t=!0;if(avTitles.forEach(function(e){1!==e.used&&(t=!1)}),!t)return $("#selectkurs-inner-wrapper").addClass("shake shake-constant"),void setTimeout(function(){$("#selectkurs-inner-wrapper").removeClass("shake shake-constant")},200);selectedKurse.forEach(function(e){GKURSE.forEach(function(t,s){t.kurse.forEach(function(t){if(e===t.fach){var s=null;GMyKurse.forEach(function(e,n){e.fach===t.fach&&(s=n)}),null===s&&GMyKurse.push(t)}})})}),$("#kurs-cloud-cb").is(":checked")?$.ajax({url:"https://www.fosefx.com/betterGymWue/kursAPI.php",type:"GET",data:"k="+JSON.stringify(GMyKurse),success:function(e){doAfterKursClick(),$("body").append("<div id='bigIDBox'><p>Dein Kurs Code:</p><span class='bigKursNumber'>"+e+"</span><br><a onclick='$(\"#bigIDBox\").remove()'>Ok</a></div>")},error:function(e){alert("Verbindung zur Datenbank fehlgeschlagen: "+e)}}):doAfterKursClick()}),$("#getKurseWithID").click(function(e){e.preventDefault(),$("body").append("<div id='diff' onclick='$(\"#diff, #bigIDBox\").remove()'></div><div id='bigIDBox'><p>Kurs-ID eingeben:</p><br><input id='KursIDBox' type='tel' maxlength='4' minlength='4'><br><br><button class='yes' onclick='loadWIthID()'><span>Ok</span></button><br><br><a onclick='$(\"#diff, #bigIDBox\").remove()'>Schlie√üen</a></div>"),$("#KursIDBox").focus()});var allowLoad=!0;$("#leftarrow, #leftbig").click(function(){slide(!0)}),$("#rightarrow, #rightbig").click(function(){slide(!1)}),$(window).keydown(function(e){"ArrowRight"==e.key&&slide(!1),"ArrowLeft"==e.key&&slide(!0)});var wasHere=!1;/**/