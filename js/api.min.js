function getStufen(){$.ajax({url:GURL+"Schueler-Stundenplan/frames/navbar.htm",beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey)},type:"GET",success:function(e){var r=e.split("var classes = ")[1].split(";")[0].replace(/(")|(\[)|(])|( )/g,"").split(",");GStufeA=r,r.forEach(function(e){$("#stufe").append("<option>"+e+"</option>")})},error:function(e,r,t){alert("Serververbindung fehlgeschlagen: "+t+"\nEin reload könnte helfen")}})}function getKurse(e){$.ajax({url:GURL+"Schueler-Stundenplan/frames/navbar.htm",beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey)},type:"GET",success:function(r){var t=[];r=r.split('<select name="week" class="selectbox" onChange="doDisplayTimetable(NavBar, topDir);">')[1],r=r.split("</select>")[0],r.split('<option value="').splice(1,2).forEach(function(e,r){t[r]=e.split('"')[0]});var n=t[0]%2===0?t[0]:t[1],a=t[0]%2!==0?t[0]:t[1],i="a"===e?n:a,l=GURL+"Schueler-Stundenplan/"+i+"/c/c"+to5erString(GStufeid)+".htm";console.log(l),$.ajax({url:l,beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey)},success:function(r){evaKurse(r,e)},error:function(e,r,t){alert("Serververbindung fehlgeschlagen: "+t+"\nEin reload könnte helfen")}})}})}function evaKurse(e,r){var t=[],n=$(e.replace(/\r?\n|\r/g,"").toUpperCase()),a=n.children("table")[0];$(a).children("tbody").children("tr")[0].remove(),a=$(a).children("tbody")[0],$(a).find("b").each(function(){"PAUSE"===$(this).html()&&$(this).parents().eq(6).attr("id","pause").html(" ")});var i=0;$(a).children("tr").each(function(e){var n=$(this);if(!n.is("#pause")){var a=[];if(""===n.html())return i++,void n.remove();n.children("td").each(function(t){var n=t;if(0!==t){var l=!1;"4"===$(this).attr("rowspan")&&(l=!0);var h=$(this).children("table").children("tbody"),s=h.children("tr");if(1===s.length){var c=s.find("font");if(1===c.length&&""!==c.html())return;var u=$(c[0]).children("b").html(),o=$(c[1]).html(),f=$(c[2]).html(),d={type:"klasse",isBig:l,fach:u,lehrer:o,raum:f,pos:[e-i+1,n-1]};a.push(d)}else{var u=s.find("font").children("b").html(),p=[];s.each(function(e){if(0!==e){var t=$($(this).children("td")[0]).children("font").html(),n=$($(this).children("td")[1]).children("font").html(),a=$($(this).children("td")[2]).children("font").html();p.push({kurs:t,raum:a}),addKurs({title:u,fach:t,lehrer:n},r)}});var d={type:"kurs",fach:u,isBig:l,raeume:p};a.push(d)}}}),t.push(a)}});for(var l=[],h=0;h<t.length;h++)if(0!==t[h].length){var s=!0;s&&l.push(t[h]);var c="a"===r?0:1}var u={days:[[],[],[],[],[]]};l.forEach(function(e,r){e.forEach(function(e,t){for(var n={},a=t,i=r,l=u.days[a][i];"undefined"!=typeof l;)i++,l=u.days[a][i];(void 0!==e.fach||"klasse"===e.fach)&&("klasse"===e.type?n={type:e.type,fach:e.fach,lehrer:e.lehrer,raum:e.raum}:"kurs"===e.type&&(n={type:e.type,fach:e.fach,raeume:e.raeume})),u.days[a][i]=n,e.isBig&&(u.days[a][i+1]=n)})});for(var h=0;5>h;h++)u.days[h].splice(6,0,{});GTimeTable[c]=u,TTLoaded()}function addKurs(e,r){for(var t=null,n="a"===r?0:1,a=0;a<GKURSE[n].kurse.length;a++)e.fach===GKURSE[n].kurse[a].fach&&(t=a);null===t&&GKURSE[n].kurse.push({fach:e.fach,lehrer:e.lehrer,title:e.title})}