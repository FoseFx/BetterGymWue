function splitter(e,t){for(var n=[];e.length>t;){var a=e.substring(0,t).lastIndexOf(" ");a=0>=a?t:a,n.push(e.substring(0,a));var r=e.indexOf(" ",a)+1;(a>r||r>a+t)&&(r=a),e=e.substring(r)}return n.push(e),n}function stopSpinner(){$("#spinner").css("opacity","0"),setTimeout(function(){$("#spinner").css("display","none"),$("#page-wraper").css("display","block"),setTimeout(function(){$("#page-wraper").css("opacity","1")},10)},200)}function startSpinner(){$("#page-wraper").css("opacity","0"),setTimeout(function(){$("#page-wraper").css("display","none"),$("#spinner").css("display","flex"),setTimeout(function(){$("#spinner").css("opacity","1")},10)},200)}function showAGB(){$("#terms").css("display","flex")}function checkLoginCookie(){var e=checkCookie("key");null!==e?login(e,1):moveInLogin()}function checkStufeCookie(){startSpinner();var e=checkCookie("stufe");null!==e?(Gstufe=e,GStufeid=checkCookie("stufeid"),accessStufe()):(moveInStufe(),getStufen()),stopSpinner(),$(".nointeract").removeClass("nointeract")}function moveInLogin(){setTimeout(function(){$("#login-wrapper").css("transform","translate(-50%,-50%)")},700)}function unAuth(){$("#login-wrapper").css("box-shadow","0px 0px 12px 0px rgba(255,36,36,1)"),$("#page-wraper").addClass("shake shake-constant"),setTimeout(function(){$("#page-wraper").removeClass("shake shake-constant"),$("#psw").val("")},200)}function moveInStufe(){$("#stufe-wrapper").removeClass("hidden").css("transform","translate(-50%, -50%)")}function Auth(e){document.cookie="key="+e+";expires=Fri, 31 Dec 9999 23:59:59 GMT",Gkey=e,$("#login-wrapper").css("opacity","0"),setTimeout(function(){$("#login-wrapper").css("display","none"),checkStufeCookie()},500)}function checkCookie(e){var t=null;return document.cookie.split(";").forEach(function(n){var a=n.split("=");a[0].replace(/\s/g,"")===e&&(t=a[1])}),t}function moveOutStufe(){$("#stufe-wrapper").css("transform","translate(-1000%, -50%)"),setTimeout(function(){$("#login-wrapper").hide()},500)}function getWeekOfYear(e){return e.getWeek()}function to5erString(e){for(var t=e;5!==t.length;)t="0"+t;return t}function scrawl(){if(allowed){allowed=!1,startSpinner();var e=Scbase+Scmid+Scurl;$.ajax({cache:!1,contentType:"Content-type: text/html; charset=iso-8859-1",url:e,beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+Gkey),e.overrideMimeType("text/html;charset=iso-8859-1")},success:function(e){Scfiles.push(Scurl),Scurl=e.split('<meta http-equiv="refresh" content="10; URL=')[1].split('">')[0],Scbodys.push(e.split('<body bgcolor="#F0F0F0">')[1].split("</body>")[0]),e=null,allowed=!0,-1===Scfiles.indexOf(Scurl)?scrawl():evaScrawl()}})}}function evaScrawl(){if(Scrawled++,1===Scrawled&&(Scbody1=Scbodys,Scmid="f2/",Scurl="subst_001.htm",Scfiles=[],Scbodys=[],scrawl()),2===Scrawled){Scbody2=Scbodys;var e=[],t=[];Scbody1.forEach(function(n){n=$(n);var a=n.find("td.info");if(0===a.length&&(a=null),null!==a){var r=[];a.each(function(){r.push($(this).html())}),r.forEach(function(t){-1===e.indexOf(t)&&e.push(t)})}var s=[];$(n.find("table.mon_list")[0]).children("tbody").children().each(function(e){if(0!==e)if(1===$(this).children().length)s.push({klasse:$(this).children(".inline_header").html(),ctnd:[]});else{var t=$(this).children(),n=[,$(t[1]).html()];-1!==n[1].indexOf(" - ")&&(n=n[1].split(" - "),s[s.length-1].ctnd.push({date:$(t[0]).html(),stunde:n[0],kurs:$(t[2]).html(),type:$(t[3]).children("b").html(),nraum:$(t[5]).html(),info:$(t[6]).html()})),s[s.length-1].ctnd.push({date:$(t[0]).html(),stunde:n[1],kurs:$(t[2]).html(),type:$(t[3]).children("b").html(),nraum:$(t[5]).html(),info:$(t[6]).html()})}}),s.forEach(function(e){var n=!1;t.forEach(function(t){t.klasse===e.klasse&&(n=!0,e.ctnd.forEach(function(e){t.ctnd.push(e)}))}),n||t.push(e)})}),e=[[],e],t=[[],t],Scbody2.forEach(function(n){n=$(n);var a=n.find("td.info");if(0===a.length&&(a=null),null!==a){var r=[];a.each(function(){r.push($(this).html())}),r.forEach(function(t){-1===e[0].indexOf(t)&&e[0].push(t)})}var s=[];$(n.find("table.mon_list")[0]).children("tbody").children().each(function(e){if(0!==e)if(1===$(this).children().length)s.push({klasse:$(this).children(".inline_header").html(),ctnd:[]});else{var t=$(this).children(),n=[,$(t[1]).html()];-1!==n[1].indexOf(" - ")&&(n=n[1].split(" - "),s[s.length-1].ctnd.push({date:$(t[0]).html(),stunde:n[0],kurs:$(t[2]).html(),type:$(t[3]).children("b").html(),nraum:$(t[5]).html(),info:$(t[6]).html()})),s[s.length-1].ctnd.push({date:$(t[0]).html(),stunde:n[1],kurs:$(t[2]).html(),type:$(t[3]).children("b").html(),nraum:$(t[5]).html(),info:$(t[6]).html()})}}),s.forEach(function(e){var n=!1;t[0].forEach(function(t){t.klasse===e.klasse&&(n=!0,e.ctnd.forEach(function(e){t.ctnd.push(e)}))}),n||t[0].push(e)})}),t.reverse(),console.log(t),console.log(e),stopSpinner();var n;t.forEach(function(a,r){var s=new Date,c=["So","Mo","Di","Mi","Do","Fr","Sa"];for(1===r&&s.setDate(s.getDate()+1);0===s.getDay()||6===s.getDay();)s.setDate(s.getDate()+1);0===r&&(n=s),1===r&&n.getDate()==s.getDate()&&s.setDate(s.getDate()+1);var o=s.getDate()+"."+(s.getMonth()+1)+".";console.log(s);var i='<div class="tag">\n                    <h1>'+c[s.getDay()]+" "+o+"</h1>\n                    <hr>\n                    <table>\n                        <tbody class='lul'>\n                            <tr><td><b>Std.</b></td><td><b>Fach</b></td><td><b>Raum</b></td><td><b>Lehrer</b></td></td><td></td></tr>\n                        </tbody>\n                    </table>\n                </div>",l=$(i),u=$(l).find("tbody.lul")[0],d=s.getWeek()%2===0?0:1,h=[];t.forEach(function(e){e.forEach(function(e){-1!==e.klasse.indexOf(Gstufe)&&e.ctnd.forEach(function(e){e.date===o&&(GMyKurse.forEach(function(t){(t.fach===e.kurs||"&nbsp;"===e.kurs)&&h.push(e)}),GTimeTable[d].days.forEach(function(t){t.forEach(function(t){t!=={}&&null!==t&&"klasse"===t.type&&t.fach===e.kurs&&h.push(e)})}))})})}),console.log(h);var f=GTimeTable[d].days[s.getDay()-1];f.forEach(function(e,n){var a="";e==={}?a="<tr><td colspan='5'>Pause</td></tr>":"klasse"===e.type?a="<tr><td class='stundeLUL'>"+(n+1)+"</td><td class='fachLUL'>"+e.fach+"</td><td class='raumLUL'>"+e.raum+"</td><td class='lehrerLUL'>"+e.lehrer+"</td></tr>":"kurs"===e.type&&GMyKurse.forEach(function(t){if(t.title===e.fach){var r=null;e.raeume.forEach(function(e){e.kurs===t.fach&&(r=e.raum)}),r=null===r?"- - -":r,a="<tr><td class='stundeLUL'>"+(n+1)+"</td><td class='fachLUL'>"+t.fach+"</td><td class='raumLUL'>"+r+"</td><td class='lehrerLUL'>"+t.lehrer+"</td></tr>"}});var r=$(a);t.forEach(function(e){"undefined"!=typeof a&&0!==e.length&&e[0].ctnd[0].date===o&&e.forEach(function(e){-1!==e.klasse.indexOf(Gstufe)&&e.ctnd.forEach(function(e){var t=e.type,n=e.stunde,a=r.find(".stundeLUL").html(),s=e.kurs.toLowerCase(),c=r.find(".fachLUL").html();c="undefined"!=typeof c?c.toLowerCase():c;var o="";o="Vertretung"==t?"blue":"Entfall"==t?"red":"green",n==a&&s==c&&(r.find(".raumLUL").html(e.nraum),r.css("color",o))})})}),a=r.wrap("<p/>").parent().html(),"undefined"!=typeof a&&(a=a.replace("undefined","?"),a=a.replace("null",""),$(u).append(a))});var p=$("<h3>Info</h3>\n<table class='hi'>\n    <tbody class=\"headerTab\">\n        \n    </tbody>\n</table>");e.forEach(function(e,n){t[n][0].ctnd[0].date===o&&e!==[]&&void 0!==e[0]&&void 0!==e[1]&&p.find(".headerTab").append("<tr><td>"+e[0]+"</td><td>"+e[1]+"</td></tr>")}),0!==$(p).find("tbody").children().length&&l.append($(p));var m=$("<h3>"+Gstufe+"</h3>\n<table class='hi'>\n   <tbody>\n       \n   </tbody>\n</table>");console.log(t),t.forEach(function(e,t){e.forEach(function(e,t){-1!==e.klasse.indexOf(Gstufe)&&e.ctnd.forEach(function(e){var t=e.type;"Vertretung"===t&&(t="Vert"),"Raum-Vtr."===t&&(t="Raum"),"Entfall"===t&&(t="Entf"),"Sondereins."===t&&(t="Sonder");var n=e.info,a=[["selbständiges arbeiten","Selbst. Arb."],["selbstständiges arbeiten","Selbst. Arb."],["aufgaben","Aufg."],["raumwechsel","RaumW."]];a.forEach(function(e){n=n.replace(new RegExp(e[0],"ig"),e[1])});var r="<tr><td><b>"+e.stunde+"</b></td><td>"+e.kurs+"</td><td>"+t+"</td><td>"+e.nraum+"</td><td>"+n+"</td></tr>";e.date===o&&m.find("tbody").append(r)})})}),0!==m.find("tbody").children().length&&l.append(m),l.append("<div class='spacer'></div>"),$("#inner-tag-wrapper").append(l)}),$("#anzeigen-wrapper").removeClass("hidden")}}$(document).ready(function(){var e=!1;document.cookie.split(";").forEach(function(t){"a=true"==t&&(e=!0)}),stopSpinner(),e||showAGB(),e&&checkLoginCookie();var t=checkCookie("key");null!==t&&(Gkey=t);var n=JSON.parse(checkCookie("tt"));null!==n&&(GTimeTable=n);var a=checkCookie("kl");if(null!==a){for(var r="",s=0;a>s;s++)r+=checkCookie("k"+s);GMyKurse=JSON.parse(r).a}}),Date.prototype.getWeek=function(){var e=new Date(this.valueOf()),t=(this.getDay()+6)%7;e.setDate(e.getDate()-t+3);var n=e.valueOf();return e.setMonth(0,1),4!=e.getDay()&&e.setMonth(0,1+(4-e.getDay()+7)%7),1+Math.ceil((n-e)/6048e5)};var Scrawled=0,Scbase=GURL+"Schueler/",Scmid="f1/",Scurl="subst_001.htm",Scfiles=[],Scbodys=[],Scbody1=null,Scbody2=null,allowed=!0;