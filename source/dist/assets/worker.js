function getWeekNumber(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));let t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-t)/864e5+1)/7)}self.addEventListener("push",function(e){console.log("push",e);let t,o,n,a=indexedDB.open("OfflineData",2);a.onerror=function(e){console.error(e)},a.onsuccess=function(e){t=a.result,o=t.transaction("DataStore","readonly"),n=o.objectStore("DataStore"),t.onerror=function(e){console.error(e)};let r=n.get("key");r.onsuccess=function(){let e=r.result.data;console.log(e);let t=e.TT,o=e.myKurse,n=new Date;for(;0===n.getDay()||6===n.getDay();)n.setDate(n.getDate()+1);let a=t[getWeekNumber(n)%2==0?0:1];t={tag:a.days[n.getDay()-1],date:n},console.log(t);let l="",c=[];t.tag.forEach(e=>{e.fach&&c.push(e)}),c.forEach((e,n)=>{l+=o.find(t=>t.title===e.fach).fach,n<t.tag.length-1&&(l+=" | ")});let s=["Mo","Di","Mi","Do","Fr"][t.date.getDay()-1];self.registration.showNotification(`Dein Stundenplan fÃ¼r ${s}`,{body:l,icon:"assets/logo/128.png"})},o.oncomplete=function(){t.close()}},a.onupgradeneeded=function(e){t=a.result,n=t.createObjectStore("DataStore")}});