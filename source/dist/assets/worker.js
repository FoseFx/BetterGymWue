function getWeekNumber(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));let t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-t)/864e5+1)/7)}self.addEventListener("push",function(e){console.log("push",e);let t,n,o,a=indexedDB.open("OfflineData",2);a.onerror=function(e){console.error(e)},a.onsuccess=function(e){t=a.result,n=t.transaction("DataStore","readonly"),o=n.objectStore("DataStore"),t.onerror=function(e){console.error(e)};let r=o.get("key");r.onsuccess=function(){let e=r.result.data;console.log(e);let t=e.TT,n=e.myKurse,o=new Date;for(;0===o.getDay()||6===o.getDay();)o.setDate(o.getDate()+1);t={tag:t[getWeekNumber(o)%2==0?0:1].days[o.getDay()-1],date:o},console.log(t);let a="",c=[];t.tag.forEach(e=>{e.fach&&c.push(e)}),c.forEach((e,t)=>{let o=n.find(t=>t.title===e.fach);o&&(e.raeume.find(e=>e.kurs===o.fach)?a+=o.fach:a+="Frei"),t<c.length-1&&(a+=" ")});let i=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"][t.date.getDay()-1];self.registration.showNotification(`Stundenplan fÃ¼r ${i} (indev)`,{body:a,icon:"assets/logo/128.png"})},n.oncomplete=function(){t.close()}},a.onupgradeneeded=function(e){t=a.result,o=t.createObjectStore("DataStore")}}),self.addEventListener("notificationclick",function(e){e.notification.close(),e.waitUntil(clients.openWindow("/"))});