function getWeekNumber(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));let t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-t)/864e5+1)/7)}self.addEventListener("push",function(e){console.log("push",e);let t=e.data.text();if("noti"!==t)return void self.registration.showNotification("BGW:",{body:t,icon:"assets/logo/128.png"});let o,n,a,i=indexedDB.open("OfflineData",2);i.onerror=function(e){console.error(e)},i.onsuccess=function(e){o=i.result,n=o.transaction("DataStore","readonly"),a=n.objectStore("DataStore"),o.onerror=function(e){console.error(e)};let t=a.get("key");t.onsuccess=function(){let e=t.result.data;console.log(e);let o=e.TT,n=e.myKurse,a=new Date;for(;0===a.getDay()||6===a.getDay();)a.setDate(a.getDate()+1);o={tag:o[getWeekNumber(a)%2==0?0:1].days[a.getDay()-1],date:a},console.log(o);let i="",r=[];o.tag.forEach(e=>{e.fach&&r.push(e)}),r.forEach((e,t)=>{let o=n.find(t=>t.title===e.fach);o&&(e.raeume.find(e=>e.kurs===o.fach)?i+=o.fach:i+="Frei"),t<r.length-1&&(i+=" ")});let s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"][o.date.getDay()-1];self.registration.showNotification(`Stundenplan fÃ¼r ${s}`,{body:i,icon:"assets/logo/128.png"})},n.oncomplete=function(){o.close()}},i.onupgradeneeded=function(e){o=i.result,a=o.createObjectStore("DataStore")}}),self.addEventListener("notificationclick",function(e){e.notification.close(),e.waitUntil(clients.openWindow("/"))});